# Подсчёт средней цены
 
 **“Подсчёт средней цены”** — 
 первый сервис, основанный на актуальных статистических данных **AUTO.RIA** (ежемесячно 10 тыс. опубликованных объявлений о продаже 7 800 марок авто, которые ежедневно собирают 8 млн. просмотров).
 
 Теперь вы можете:
 * узнавать актуальные средние цены автомобилей разных марок и моделей; 
 * следить за изменениями цен в кратко- и долгосрочном периодах;
 * анализировать и прогнозировать изменения цен и спроса на автомобили;
 * размещать полученную информацию на вашем сайте.
 
 
 
 Ознакомьтесь с технической документацией, чтобы получить доступ и экспортировать необходимую информацию в программу вашей компании.
 
 
### Формат данных в запросе

Все параметры описанные в таблице поддерживаемых параметров должны передаватся в виде чисел. Исключениями являются только параметры - *год выпуска*. *пробег*, *опции* и *коробка передач*.

Если передать массив в параметре *коробка передач*, то это будет интерпретироваться как поиск коробок передач с логическим оператором *ИЛИ*. Т.е. `https://developers.ria.com/auto/average_price?api_key=YOUR_API_KEY&marka_id=9&model_id=31612&`
`gear_id=1&gear_id=2` 
- выберет для подсчета все **BMW 318** с автоматическими и ручными коробками передач. Аналогично и с параметром *тип топлива*, например: `https://developers.ria.com/auto/average_price?api_key=YOUR_API_KEY&marka_id=9&model_id=31887&`
`yers=2014&fuel_id=1&fuel_id=2`
- выберет для подсчета все **BMW 520 2014 года** с дизельными и бензиновыми двигателями.  

Если передать массив в параметре *год выпуска* или *пробег* это будет интерпретироваться как диапазон значений. Например, `https://developers.ria.com/auto/average_price?api_key=YOUR_API_KEY&raceInt=10&raceInt=100` - выберет для подсчета средней цены все объявления с пробегом от 10 до 100 тыс. км.

Если передать массив значений в параметре *опции* это будет интерпретироваться как поиск опций с логическим оператором "И". Т.е. `https://developers.ria.com/auto/average_price?api_key=YOUR_API_KEY&options=217&options=463` выберет для подсчета все объявления, у которых есть опция *ABS* **И** *Галогенные фары*.

### Формат данных в ответе

В случае успешного подсчета средней цены по указанным параметрам результат будет со статусом **200 OK**.

Пример успешного ответа:
```javascript
{
    total: 17,
    arithmeticMean: 16305.882352941177,
    interQuartileMean: 8483.333333333334,
    percentiles: {
        1.0: 1944,
        5.0: 2520,
        25.0: 3500,
        50.0: 8000,
        75.0: 23500,
        95.0: 53539.999999999985,
        99.0: 64868
    },
    prices: [
        67700,
        27000,
        3000,
        23500,
        3500,
        8100,
        10000,
        3500,
        2700,
        8000,
        11000,
        45800,
        50000,
        1800,
        4350,
        4400,
        2850
    ],
    classifieds: [
        14663610,
        14226353,
        14138132,
        13969588,
        14697569,
        13386778,
        13279188,
        14555863,
        14754932,
        14816842,
        14664706,
        13873344,
        14681607,
        14772056,
        14059841,
        14290096,
        14890250
    ]
}
```
Расшифровка параметров:
- *total* - общее количество объявлений, учавствующих в подсчете.
- *arithmeticMean* - [среднее арифметическое](https://ru.wikipedia.org/wiki/%D0%A1%D1%80%D0%B5%D0%B4%D0%BD%D0%B5%D0%B5_%D0%B0%D1%80%D0%B8%D1%84%D0%BC%D0%B5%D1%82%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%BE%D0%B5).
- *interQuartileMean* - среднее арифметическое из значений, находящихся между первым и четвертым [квантилем](https://ru.wikipedia.org/wiki/%D0%9A%D0%B2%D0%B0%D0%BD%D1%82%D0%B8%D0%BB%D1%8C). Грубо говоря, это среднее арифметическое без учета 25% самых маленьких и самых больших значений.
- *percentiles* - значения [процентилей](https://ru.wikipedia.org/wiki/%D0%9A%D0%B2%D0%B0%D0%BD%D1%82%D0%B8%D0%BB%D1%8C#.D0.9F.D0.B5.D1.80.D1.86.D0.B5.D0.BD.D1.82.D0.B8.D0.BB.D1.8C). Т.е. для данного примера 25% всех объявлений имеют цену ниже $3500.
- *prices* - список цен, которые учавствовали в подсчете средней цены. Размер ограничен 1000 элементов.
- *classifieds* - идентификаторы объявлений, к которым принадлежат цены соответственно. Размер ограничен 1000 элементов.

Записи в поля "classifields" и "prices" идут в одинаковом порядке.

Если по каким-либо причинам не удалось подсчитать среднюю цену, ответ будет иметь статус **400 Bad Request**, а тело ответа будет содержать следующее:
```javascript
{ "message": "Not Enough Data" }
```

### Примеры

Средняя цена по BMW X5 с пробегом от 10 до 100 тыс. км. - [https://developers.ria.com/auto/average_price?api_key=YOUR_API_KEY&marka_id=9&model_id=96&raceInt=10&raceInt=100](https://developers.ria.com/auto/average_price?api_key=YOUR_API_KEYd&marka_id=9&model_id=96&raceInt=10&raceInt=100).


Средняя цена для Honda Accord в Киеве - [https://developers.ria.com/auto/average_price?api_key=YOUR_API_KEY&marka_id=28&model_id=262&city_id=9](https://developers.ria.com/auto/average_price?api_key=YOUR_API_KEY&marka_id=28&model_id=262&city_id=9)
 
